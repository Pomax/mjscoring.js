<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="base.html">

<polymer-element name="mj-set" extends="mj-base" attributes="type" >

  <template>
    <link rel="stylesheet" href="style/mj-ui.css">
    <link rel="stylesheet" href="style/mj-set.css">

    <input id="tiles" type="text" value="">

    <button id="characters">満</button>
    <button id="bamboo">竹</button>
    <button id="dots">◎</button>

    <input id="concealed" type="checkbox">

  </template>

  <script>
    var suits = ["characters","bamboo","dots"];
    Polymer("mj-set", {
      domReady: function() {
        var self = this;
        suits.forEach(function(l) {
          self.$[l].addEventListener("click", self.press);
        });
      },
      reset: function() {
        this.$.tiles.value='';
        this.$.concealed.checked = false;
        this.$.concealed.removeAttribute("checked");
        this.find("button").forEach(this.unpress);
        this.properties = false;
      },
      empty: function() {
        return this.$.tiles.value.trim() === '';
      },
      getSuit: function() {
        var b = this.find(".pressed");
        if(!b || !b[0]) return false;
        return b[0].id;
      },
      getTiles: function() {
        var v = this.$.tiles.value;
        v = v.split('').map(function(v) {
          if(parseInt(v,10) == v) {
            return parseInt(v,10);
          }
          return v;
        });
        return v;
      },
      getConcealed: function() {
        var b = this.find("input[type=checkbox]")[0];
        return b.checked || false;
      }
    });
  </script>

</polymer-element>
