<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="base.html">
<link rel="import" href="mj-rules-chinese-classical.html">

<polymer-element name="mj-rules" extends="mj-base">

  <template>
    <link rel="stylesheet" href="style/mj-ui.css">
    <div id="rules">
      <mj-rules-chinese-classical></mj-rules-chinese-classical>
    </div>
  </template>

  <script>
    Polymer("mj-rules", {
      domReady: function() {
        this.ruleset = this.$.rules.children[0];
        this.base = this.ruleset.base;
      },
      limits: function() {
        return this.ruleset.limits;
      },
      rotate: function(wind) {
        return this.ruleset.rotate(wind);
      },
      score: function(player, windoftheround, winds, extras) {
        var sets = player.getSets();
        var bonus = player.getBonus();
        var limit = player.getLimit();
        var ownwind = player.wind;
        var score = this.ruleset.makeScoreObject();

        this.ruleset.preprocess(score, bonus, sets, ownwind, windoftheround);
        this.ruleset.scoreBonus(score, bonus, ownwind, windoftheround);
        this.ruleset.scoreSets(score, sets, ownwind, windoftheround);
        this.ruleset.scoreWinner(score, limit, sets, ownwind, windoftheround, extras);
        this.ruleset.capLimit(score);

        return score;
      },
      award: function(players, scores) {
        this.ruleset.award(players.slice(), scores);
      }
    });
  </script>

</polymer-element>
